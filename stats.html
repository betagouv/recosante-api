---
layout: home
---

<script type="text/javascript" src="./assets/js/Chart.min.js"></script>
<link rel="stylesheet" href="./assets/css/Chart.min.css">
<link rel="stylesheet" href="./assets/css/stats.css">


<section class="section section-grey">
    <div class="container">
        <div class="panel">
            <h1><span class="number">{{ site.data.stats.actifs.total }}</span> utilisateurs actifs</h1>
            <canvas id="total_subscriptions"></canvas>
        </div>
        <div class="panel user_pref">
            <h1>Préférence des utilisateurs</h1>
            <div>
                <div class="half_donut">
                    <canvas id="user_formats"></canvas>
                </div>
                <div class="half_donut">
                    <canvas id="user_frequencies"></canvas>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
var color = Chart.helpers.color;
var totalSubscriptionsChartData = {
        labels: ["{{ site.data.stats.actifs.data | map: "mois" | join: '", "' }}"],
        datasets: [{
            label: '# inscrits',
            data: [{{ site.data.stats.actifs.data | map: "valeur" | join: ", " }}],
            backgroundColor: color('rgb(54, 162, 235)').alpha(0.5).rgbString(),
            borderColor: 'rgb(54, 162, 235)',
            borderWidth: 1
        }]
};
var formatChartData = {
    labels: ['SMS', 'Mail'],
    datasets: [{
        label: 'format',
        data: [
            {{ site.data.stats.sms.total }},
            {{ site.data.stats.mails.total}}
        ],
        backgroundColor: [
            '#ffa725',
            '#2fa0f2'
        ]
    }]
}
var frequencyChartData = {
    labels: ['Tous les jours', "Lorsque la qualité de l'air est mauvaise"],
    datasets: [{
        label: 'frequency',
        data: [
            {{ site.data.stats.quotidienne.total }},
            {{ site.data.stats.mauvaise_qa.total}}
        ],
        backgroundColor: [
            '#ffa725',
            '#2fa0f2'
        ]
    }]
}
window.onload = function() {
    var ctx_total = document.getElementById('total_subscriptions').getContext('2d');
    window.totalSubscriptionsChart = new Chart(ctx_total, {
        type: 'bar',
        data: totalSubscriptionsChartData
    })

    var ctx_format = document.getElementById('user_formats').getContext('2d');
    window.formatChart = new Chart(ctx_format, {
        type: 'doughnut',
        data: formatChartData,
        options: {
            responsive: true,
            title: {
                display: true,
                text: 'Format',
                verticalAlign: "center",
                dockInsidePlotArea: true
            }
        }
    })
    var ctx_frequencies = document.getElementById('user_frequencies').getContext('2d');
    window.formatChart = new Chart(ctx_frequencies, {
        type: 'doughnut',
        data: frequencyChartData,
        options: {
            responsive: true,
            title: {
                display: true,
                text: 'Fréquence',
                verticalAlign: "center",
                dockInsidePlotArea: true
            }
        }
    })                
}
</script>